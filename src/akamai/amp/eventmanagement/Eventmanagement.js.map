{"version":3,"file":"Eventmanagement.js","sources":["../../../../src/EventManagement.js","../../../../src/main.js"],"sourcesContent":["export default class EventManagement extends akamai.amp.Plugin {\n\n  constructor(player, config) {\n    super(player, config)\n\n    this.poller = new akamai.amp.Poller()\n    this.poller.ondatachange = (event) => {\n      const id = event.detail\n      let state = null\n\n      if (id == \"on\") {\n        state = {id: \"on\"}\n      }\n      else {\n        const states = this.states\n        for (let i = 0, len = this.states.length; i < len; i++) {\n          if (states[i].id == id) {\n            state = states[i]\n            break\n          }\n        }\n      }\n\n      if (state != null) {\n        this.state = state\n      }\n    }\n\n    this.states = config.states || []\n    this.url = config.url\n    this.interval = config.interval || 5\n    this.poster = document.createElement(\"img\")\n    this.poster.className = \"amp-event-poster\"\n  }\n\n  set url(value) {\n    this.poller.url = value\n  }\n\n  get url() {\n    return this.poller.url\n  }\n\n  get interval() {\n    return this.poller.interval / 1000\n  }\n\n  set interval(value) {\n    this.poller.interval = value * 1000\n  }\n\n  set state(value) {\n    if (this._state == value)\n      return\n\n    this._state = value\n    this.dispatchEvent(new akamai.amp.Event(\"statechange\", value))\n\n    switch (this._state.id) {\n      case \"on\":\n        if (this.player.container.contains(this.poster)) {\n          this.player.container.removeChild(this.poster)\n        }\n        if (this.player.autoplay === true)\n          this.player.play()\n      break\n\n      default:\n        if (this._state.poster != null) {\n          this.poster.src = this._state.poster\n          this.player.container.appendChild(this.poster)\n        }\n        this.player.pause()\n        this.player.displayState = akamai.amp.DisplayState.NORMAL\n      break\n    }\n  }\n\n  get state() {\n    return this._state\n  }\n\n  onready() {\n    this.poller.start()\n  }\n}\n","import \"./EventManagement.less\"\nimport EventManagement from \"./EventManagement.js\"\n\nakamai.amp.AMP.registerPlugin(\"eventmanagement\", EventManagement.factory)\n\nexport {EventManagement}\n"],"names":["EventManagement","player","config","poller","akamai","amp","Poller","ondatachange","event","id","detail","state","states","i","len","length","url","interval","poster","document","createElement","className","start","value","_state","dispatchEvent","Event","container","contains","removeChild","autoplay","play","src","appendChild","pause","displayState","DisplayState","NORMAL","Plugin","AMP","registerPlugin","factory"],"mappings":";;;;;IAAqBA;;;2BAEPC,MAAZ,EAAoBC,MAApB,EAA4B;;;8IACpBD,MADoB,EACZC,MADY;;UAGrBC,MAAL,GAAc,IAAIC,OAAOC,GAAP,CAAWC,MAAf,EAAd;UACKH,MAAL,CAAYI,YAAZ,GAA2B,UAACC,KAAD,EAAW;UAC9BC,KAAKD,MAAME,MAAjB;UACIC,QAAQ,IAAZ;;UAEIF,MAAM,IAAV,EAAgB;gBACN,EAACA,IAAI,IAAL,EAAR;OADF,MAGK;YACGG,SAAS,MAAKA,MAApB;aACK,IAAIC,IAAI,CAAR,EAAWC,MAAM,MAAKF,MAAL,CAAYG,MAAlC,EAA0CF,IAAIC,GAA9C,EAAmDD,GAAnD,EAAwD;cAClDD,OAAOC,CAAP,EAAUJ,EAAV,IAAgBA,EAApB,EAAwB;oBACdG,OAAOC,CAAP,CAAR;;;;;;UAMFF,SAAS,IAAb,EAAmB;cACZA,KAAL,GAAaA,KAAb;;KAlBJ;;UAsBKC,MAAL,GAAcV,OAAOU,MAAP,IAAiB,EAA/B;UACKI,GAAL,GAAWd,OAAOc,GAAlB;UACKC,QAAL,GAAgBf,OAAOe,QAAP,IAAmB,CAAnC;UACKC,MAAL,GAAcC,SAASC,aAAT,CAAuB,KAAvB,CAAd;UACKF,MAAL,CAAYG,SAAZ,GAAwB,kBAAxB;;;;;;8BAkDQ;WACHlB,MAAL,CAAYmB,KAAZ;;;;sBAhDMC,OAAO;WACRpB,MAAL,CAAYa,GAAZ,GAAkBO,KAAlB;;wBAGQ;aACD,KAAKpB,MAAL,CAAYa,GAAnB;;;;wBAGa;aACN,KAAKb,MAAL,CAAYc,QAAZ,GAAuB,IAA9B;;sBAGWM,OAAO;WACbpB,MAAL,CAAYc,QAAZ,GAAuBM,QAAQ,IAA/B;;;;sBAGQA,OAAO;UACX,KAAKC,MAAL,IAAeD,KAAnB,EACE;;WAEGC,MAAL,GAAcD,KAAd;WACKE,aAAL,CAAmB,IAAIrB,OAAOC,GAAP,CAAWqB,KAAf,CAAqB,aAArB,EAAoCH,KAApC,CAAnB;;cAEQ,KAAKC,MAAL,CAAYf,EAApB;aACO,IAAL;cACM,KAAKR,MAAL,CAAY0B,SAAZ,CAAsBC,QAAtB,CAA+B,KAAKV,MAApC,CAAJ,EAAiD;iBAC1CjB,MAAL,CAAY0B,SAAZ,CAAsBE,WAAtB,CAAkC,KAAKX,MAAvC;;cAEE,KAAKjB,MAAL,CAAY6B,QAAZ,KAAyB,IAA7B,EACE,KAAK7B,MAAL,CAAY8B,IAAZ;;;;cAIE,KAAKP,MAAL,CAAYN,MAAZ,IAAsB,IAA1B,EAAgC;iBACzBA,MAAL,CAAYc,GAAZ,GAAkB,KAAKR,MAAL,CAAYN,MAA9B;iBACKjB,MAAL,CAAY0B,SAAZ,CAAsBM,WAAtB,CAAkC,KAAKf,MAAvC;;eAEGjB,MAAL,CAAYiC,KAAZ;eACKjC,MAAL,CAAYkC,YAAZ,GAA2B/B,OAAOC,GAAP,CAAW+B,YAAX,CAAwBC,MAAnD;;;;wBAKM;aACH,KAAKb,MAAZ;;;;EA/EyCpB,OAAOC,GAAP,CAAWiC;;ACGxDlC,OAAOC,GAAP,CAAWkC,GAAX,CAAeC,cAAf,CAA8B,iBAA9B,EAAiDxC,kBAAgByC,OAAjE,EAEA;;;;"}