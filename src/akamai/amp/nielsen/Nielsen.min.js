!function(e){"use strict";var t=function(e){function t(e,a){babelHelpers.classCallCheck(this,t);var i=babelHelpers.possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return i.bindHandlers(["onadstarted","onadended","onadtimeupdate"]),i.sdk=window.NOLCMB.getInstance(),i.isDTVR=!0===i.config.data.dtvr,window.addEventListener("beforeunload",function(){return i.fireBeacon("end",i.currentTime.toFixed(0))}),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"generateNielsenVO",value:function(e){var t={},a=this.config.events;switch(e){case"content":null!=a.video&&(t=a.video);break;case"static":t=a.static;break;default:t=a.ad,t.type=e}return t}},{key:"fireBeacon",value:function(e,t){var a={loadmetadata:15,play:5,stop:7,timeupdate:49,end:57,sendID3:55};this.player.logger.log("[AMP Nielsen DCR Event] : Event - "+e,t),this.sdk.ggPM(a[e],t)}},{key:"onready",value:function(){var e=this.player.ads;null!=e&&(e.addEventListener("onadstarted",this.onadstarted),e.addEventListener("onadended",this.onadended),e.addEventListener("onadtimeupdate",this.onadtimeupdate))}},{key:"onadstarted",value:function(e){this.adVO=e.detail;var t=this.adVO.type;"midroll"==t&&1==this.adVO.position&&this.fireBeacon("stop",this.currentTime),"preroll"==t&&this.fireBeacon("loadmetadata",this.generateNielsenVO("content")),null!=this.adVO&&this.fireBeacon("loadmetadata",this.generateNielsenVO(t))}},{key:"onadended",value:function(){this.fireBeacon("stop",this.currentTime),"midroll"==this.adVO.type&&this.adVO.totalAds==adVO.position&&this.fireBeacon("loadmetadata",this.generateNielsenVO("content"))}},{key:"onadtimeupdate",value:function(e){var t=Math.floor(e.detail);this.currentTime!=t&&(this.currentTime=t,this.fireBeacon("timeupdate",this.currentTime))}},{key:"onstarted",value:function(){this.adVO&&"midroll"==this.adVO.type?this.fireBeacon("stop",this.generateNielsenVO(this.adVO.type)):this.fireBeacon("loadmetadata",this.generateNielsenVO("content"))}},{key:"onended",value:function(){this.fireBeacon("end",this.currentTime)}},{key:"ontimeupdate",value:function(e){var t=this.player.media.isLive?e.detail:Date.now()/1e3;t=Math.floor(t),this.currentTime!=t&&(this.currentTime=t,this.fireBeacon("timeupdate",this.currentTime))}},{key:"onmediasequenceaborted",value:function(){this.fireBeacon("end",this.currentTime)}},{key:"ontimedmetadata",value:function(e){this.isDTVR&&this.fireBeacon("sendID3",e.data.body.info)}}]),t}(akamai.amp.Plugin);akamai.amp.AMP.registerPlugin("nielsen",t.factory),e.Nielsen=t}(this.akamai.amp.nielsen=this.akamai.amp.nielsen||{});
//# sourceMappingURL=akamai/amp/nielsen/Nielsen.min.js.map